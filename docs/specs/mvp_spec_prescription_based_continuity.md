# MVP 스펙: 처방전/조제내역서 기반 연속진료 요약(환자 주도) v0.1

## 1) MVP 목표
- 환자가 병원 이동(의원↔병원↔종합병원) 시 **과거 복약/경과 정보를 빠르게 정리**해서
  다음 의료진이 **짧은 시간에 참고**할 수 있게 한다.

## 2) MVP 비목표(명시적으로 하지 않는 것)
- EMR/OCS 직접 연동
- 응급 상황 커버
- **질환/진단 후보 추정 제공**(의사용이라도 금지)
- 장기 의료문서 보관함(원본 이미지 장기 저장)
- 병원/의사 계정 기반 운영(로그인 기반은 후속)

## 3) 사용자/역할
- **환자(필수)**: 앱 사용자, 데이터 입력/공유 주체
- **의료진(읽기 전용, MVP)**: 로그인 없이 1회성 코드로 “1장 요약” 열람

## 4) 입력 데이터(환자)
- **병원 선택**: 병원 검색/선택(가칭 “방문 병원”)
- **문서 업로드(선택)**:
  - 종이 처방전 사진
  - 조제내역서(복약안내문/조제내역서/영수증 등) 사진
  - 온보딩 기본값(확정): **조제내역서(약국 종이) 촬영을 우선 안내**(처방전은 선택/추가)
- **환자 문진/기록(대기 중 2~3분)**:
  - 주증상(선택 + 자유서술)
  - 시작 시점(언제부터)
  - 경과(호전/악화/변화없음 + 변화 시점)
  - 복약 순응도(예/부분/아니오 + 이유)
  - 부작용/알레르기(예/아니오 + 내용)
  - 의사가 말한 요지(환자 메모 1~2문장)

## 5) 처리(시스템)
### 5.1 OCR/구조화
- 문서 이미지에서 다음을 **가능한 범위에서** 추출:
  - 약품명(가능하면 성분/제품명 구분)
  - 용량/횟수/기간
  - 처방일(있으면)
  - 조제일(있으면)
- 약품명 정규화 수준(MVP 확정):
  - **A안: OCR로 읽은 문자열 그대로 저장/표시**(성분/제품명 매핑은 하지 않음)
- 추출 실패/불확실 항목은 **“확인 필요”**로 표시

### 5.2 사실 기반 체크(질환 추정 금지)
- 중복 가능성(동일 성분/유사 성분) 표시(“가능성/확인 필요” 수준)
- 기간 겹침/누락(환자 순응도 응답과 상충) 표시
- 알레르기/부작용 응답과 약력의 충돌 가능성 표시(확인 필요)

## 6) 출력(의료진 1장 요약 화면, MVP 필수)
### 6.1 요약(기본 펼침)
- 방문 병원/생성 시각
- 주증상(요약) + 시작 시점
- 약력 타임라인(최근 30/90일 토글, **기본 90일(확정)**)
- 경과 요약(환자 입력 기반) + 핵심 변화 시점
- 복약 순응도 요약
- 부작용/알레르기 요약
- “확인 필요” 리스트(불확실 OCR, 충돌 가능성)

### 6.2 원문 펼치기(섹션별)
- 환자 자유서술 원문(출처: 환자 작성)
- “의사가 말한 요지” 원문(출처: 환자 작성)
- OCR 추출 원문/신뢰 표시(출처: 문서 OCR)
- 원본 이미지: **MVP 정책상 서버 저장 없음**
  - (구현 선택지) 온디바이스 OCR로 이미지 미전송/즉시 폐기 또는 서버 즉시 처리 후 즉시 삭제

## 6.3 환자 앱 “첫 결과 화면”(B2C 훅, MVP 권장)
- 조제내역서 촬영/OCR 직후 환자가 가장 먼저 보는 화면은 다음 2가지를 함께 제공한다(결정):
  - **A안**: “현재 복용중” 약을 크게 요약(약 이름/OCR 원문, 복용 기간/횟수/남은 일수 추정은 가능한 범위에서)
  - **C안**: “복약 알림 설정”을 즉시 제공(원탭 설정, 기본값 추천)
- 목적:
  - 병원 이동/전원 계획이 없어도 “오늘 당장” 편익(내가 먹는 약을 바로 파악 + 알림)을 제공하여 첫 사용 이유를 만든다.
  - 이후 진료실에서 “의사에게 보여주기(1장 요약)”로 자연스럽게 연결한다.

## 7) 공유/열람 흐름(로그인 없는 MVP)
- 환자: “의사에게 보여주기” 버튼 → **1회성 QR/코드 생성**
- 의료진: QR/코드로 열람
- 보안 가드레일(최소):
  - 1회성 토큰(규칙 확정): **TTL(10분) 내 재열람 허용**, TTL 만료 시 열람 불가
  - 짧은 만료시간(TTL) 기본 **10분(확정)**(설정 가능)
  - 재발급(규칙 확정): **환자만 재발급 가능**, 재발급 즉시 기존 코드/토큰 폐기
  - 열람 로그(누가/언제/무슨 코드로 열람했는지)

## 8) 개인정보/보안(최소 요건)
- 민감정보(건강정보) 취급 전제
- 데이터 최소화: 원본 이미지 저장하지 않음, 텍스트도 필요한 항목만 저장
- 이미지 처리(확정):
  - **서버 업로드 → 즉시 OCR 처리 → 원본 이미지 즉시 삭제(무저장)**
- 전송/저장 암호화, 접근통제(의료진 열람은 토큰 기반), 감사 로그
- 동의:
  - 수집·이용 동의(항목/목적/보관기간)
  - 제3자 제공(공유) 동의(제공받는 자=환자가 선택한 병원/의료진, 제공 항목/기간)
  - 철회/삭제(환자)

## 9) MVP 성공 지표(초안)
- 대기 중 설문 완료율
- 의사 화면 열람률(QR 스캔률)
- “유용했다” 의료진 피드백(정성/CS)
- 환자 재방문 시 재사용률(두 번째 병원 방문에서 재사용)

## 10) 오픈 이슈
- (해결) OCR 처리 방식 확정: **서버 즉시 처리(무저장)**
- (해결) 약품명 정규화 수준(MVP): **OCR 원문 그대로(A안)**
- 추후 고도화: 약품명 정규화/성분 매핑(Phase 1)
- 의료진 화면 접근 보안(추가적인 PIN, 대기실 IP 제한 등) 필요 여부


